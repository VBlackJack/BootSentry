<Window x:Class="BootSentry.UI.Views.SettingsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Parametres - BootSentry"
        Height="550" Width="500"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{DynamicResource WindowBackground}">

    <Window.Resources>
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="Margin" Value="0,16,0,8"/>
        </Style>
        <Style x:Key="SettingLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource WindowForeground}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="SettingDescription" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource DisabledForeground}"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   Text="Parametres"
                   FontSize="24" FontWeight="Bold"
                   Foreground="{DynamicResource WindowForeground}"/>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,16,0,0">
            <StackPanel>
                <!-- General Section -->
                <TextBlock Text="General" Style="{StaticResource SectionHeader}"/>

                <Grid Margin="0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="150"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Langue" Style="{StaticResource SettingLabel}"/>
                        <TextBlock Text="Redemarrage requis pour certains elements" Style="{StaticResource SettingDescription}"/>
                    </StackPanel>
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding Languages}"
                              SelectedValue="{Binding SelectedLanguage}"
                              SelectedValuePath="Code"
                              DisplayMemberPath="Name"
                              VerticalAlignment="Center"/>
                </Grid>

                <CheckBox Content="Demarrer en mode Expert par defaut"
                          IsChecked="{Binding IsExpertModeDefault}"
                          Foreground="{DynamicResource WindowForeground}"
                          Margin="0,8"/>

                <CheckBox Content="Verifier les mises a jour au demarrage"
                          IsChecked="{Binding CheckForUpdatesOnStartup}"
                          Foreground="{DynamicResource WindowForeground}"
                          Margin="0,8"/>

                <CheckBox Content="Afficher l'assistant au premier demarrage"
                          IsChecked="{Binding ShowOnboarding}"
                          Foreground="{DynamicResource WindowForeground}"
                          Margin="0,8"/>

                <!-- Appearance Section -->
                <TextBlock Text="Apparence" Style="{StaticResource SectionHeader}"/>

                <Grid Margin="0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="150"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Theme" Style="{StaticResource SettingLabel}"/>
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding Themes}"
                              SelectedIndex="{Binding SelectedThemeIndex}"
                              DisplayMemberPath="Name"
                              VerticalAlignment="Center"/>
                </Grid>

                <!-- Backup Section -->
                <TextBlock Text="Sauvegardes" Style="{StaticResource SectionHeader}"/>

                <Grid Margin="0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Conservation des backups" Style="{StaticResource SettingLabel}"/>
                        <TextBlock Text="0 = conserver indefiniment" Style="{StaticResource SettingDescription}"/>
                    </StackPanel>
                    <TextBox Grid.Column="1"
                             Text="{Binding BackupRetentionDays, UpdateSourceTrigger=PropertyChanged}"
                             VerticalAlignment="Center"
                             HorizontalContentAlignment="Center"/>
                    <TextBlock Grid.Column="2" Text=" jours"
                               Style="{StaticResource SettingLabel}"
                               Margin="4,0,0,0"/>
                </Grid>

                <!-- Advanced Section -->
                <TextBlock Text="Avance" Style="{StaticResource SectionHeader}"/>

                <CheckBox Content="Calculer automatiquement les hashes SHA-256"
                          IsChecked="{Binding AutoCalculateHashes}"
                          Foreground="{DynamicResource WindowForeground}"
                          Margin="0,8"/>

                <TextBlock Text="Attention: peut ralentir le scan pour les gros fichiers"
                           Style="{StaticResource SettingDescription}"
                           Margin="20,0,0,0"/>

                <!-- Danger Zone -->
                <TextBlock Text="Zone de danger" Style="{StaticResource SectionHeader}"
                           Foreground="{DynamicResource ErrorBrush}"/>

                <Button Content="Reinitialiser les parametres"
                        Command="{Binding ResetToDefaultsCommand}"
                        Padding="12,8"
                        Margin="0,8"
                        HorizontalAlignment="Left"
                        Background="{DynamicResource ControlBackground}"
                        Foreground="{DynamicResource ControlForeground}"
                        BorderBrush="{DynamicResource BorderBrush}"/>

                <Button Content="Purger toutes les donnees"
                        Command="{Binding PurgeAllDataCommand}"
                        Padding="12,8"
                        Margin="0,8"
                        HorizontalAlignment="Left"
                        Background="{DynamicResource ErrorBrush}"
                        Foreground="White"
                        BorderThickness="0"/>

                <TextBlock Text="Supprime les logs, backups et preferences"
                           Style="{StaticResource SettingDescription}"
                           Foreground="{DynamicResource ErrorBrush}"
                           Margin="0,0,0,16"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Grid Grid.Row="2" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0"
                       Text="{Binding StatusMessage}"
                       Foreground="{DynamicResource DisabledForeground}"
                       VerticalAlignment="Center"/>

            <Button Grid.Column="1"
                    Content="Fermer"
                    Click="CloseButton_Click"
                    Padding="24,8"
                    Background="{DynamicResource AccentBrush}"
                    Foreground="{DynamicResource AccentForeground}"
                    BorderThickness="0"/>
        </Grid>
    </Grid>
</Window>
